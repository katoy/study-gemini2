# Reversi (リバーシ) - Python & Pygame

![Reversi Screenshot](screenshot.png)

## 概要

このプロジェクトは、Python と Pygame を使用して開発されたリバーシゲームです。人間同士の対戦はもちろん、人間対AI、AI対AIの対戦も楽しめます。3種類のAIエージェントが実装されており、それぞれ異なる戦略で対戦します。

## 特徴

*   **直感的な操作:** マウス操作で簡単に石を置くことができます。
*   **多彩な対戦モード:** 人間対人間、人間対AI、AI対AIの対戦が可能です。
*   **3種類のAIエージェント:**
    *   **FirstAgent:** 合法手の中で最初に見つかった手を置くシンプルなAI。
    *   **RandomAgent:** 合法手の中からランダムに手を選ぶAI。
    *   **GainAgent:** ひっくり返せる石の数が最大になる手を選ぶ戦略的なAI。
*   **ゲーム履歴:** ゲームの進行を履歴として保存し、←キーと→キーで履歴を戻ったり進んだりできます。
*   **アニメーション:** 石を置く、ひっくり返すなどのアニメーションが実装されており、視覚的に楽しめます。
*   **リスタート機能:** ゲームをリスタートすることができます。
*   **ゲーム開始機能:** ゲーム開始ボタンでゲームを開始することができます。
*   **日本語対応:** 日本語のメッセージやフォントに対応しています。
*   **ユニットテスト:** ユニットテストが実装されており、コードの品質を保っています。
*   **パス機能:** 合法手がない場合、自動的にパスします。

## 動作環境

*   Python 3.7 以上
*   Pygame

## インストール

1.  リポジトリをクローンします。

    ```bash
    git clone https://github.com/your-username/reversi-py.git
    ```

2.  必要なライブラリをインストールします。

    ```bash
    pip install pygame
    ```

## 実行方法

1.  プロジェクトのルートディレクトリに移動します。

    ```bash
    cd reversi-py
    ```

2.  `main.py` を実行します。

    ```bash
    python3 main.py
    ```

## 使い方

*   **ゲーム開始:** 画面中央の「ゲーム開始」ボタンをクリックします。
*   **石を置く:** 合法手が表示されているマスをクリックします。
*   **リスタート:** ゲーム中またはゲームオーバー時に画面下部の「リスタート」ボタンをクリックします。
*   **ゲーム履歴:** ←キーで履歴を戻り、→キーで履歴を進みます。

## AIエージェントの詳細

このゲームには、以下の3種類のAIエージェントが実装されています。

*   **FirstAgent:** 合法手の中で最初に見つかった手を置きます。最も単純なAIです。
*   **RandomAgent:** 合法手の中からランダムに手を選びます。予測不能な動きが特徴です。
*   **GainAgent:** ひっくり返せる石の数が最大になる手を選びます。より戦略的な思考を持つAIです。

## テスト

テストを実行するには、以下のコマンドを使用します。

```bash
python3 -m unittest discover -s test -p "test_*.py"
```

## テストカバレッジの計測
テストカバレッジを計測するには、coverage.py を使用します。

coverage.py をインストールします。

```bash
pip install coverage
```

カバレッジ計測付きでテストを実行します。

```bash
python3 -m coverage run -m unittest discover -s test -p "test_*.py"
```

テキスト形式のカバレッジレポートを生成します。

```bash
python3 -m coverage report -m
```

HTML形式のカバレッジレポートを生成します。

```bash
python3 -m coverage html
```

HTMLレポートは htmlcov ディレクトリに生成されます。htmlcov/index.html をブラウザで開いて確認してください。

カバレッジレポートを削除します。

```bash
python3 -m coverage erase
```

## ファイル構成

```
reversi-py/
├── agent.py          # AIエージェントの定義 (FirstAgent, RandomAgent, GainAgent)
├── board.py          # ボードのロジック (石の配置、合法手の判定など)
├── game.py           # ゲームのロジック (ターン管理、ゲームオーバー判定など)
├── gui.py            # GUIのロジック (描画、アニメーション、ボタンなど)
├── main.py           # メインプログラム (ゲームの実行)
├── test/
│   ├── test_agent.py   # AIエージェントのテスト
│   ├── test_board.py   # ボードのテスト
│   ├── test_game.py    # ゲームのテスト
│   └── test_gui.py     # GUIのテスト
└── README.md         # このファイル
```

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。詳細については、LICENSE ファイルを参照してください。
